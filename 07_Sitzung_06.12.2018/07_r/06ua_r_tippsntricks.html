<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<title>Tipps für logistische Regression in R</title>

<!-- https://yihui.name/en/2018/07/latex-math-markdown/-->
<!-- Just one possible MathJax CDN below. You may use others. -->
<!--<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"async></script>-->
<!--<script src="//yihui.name/js/math-code.js"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>


<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.js"></script>

<!-- calender cdn -->
<script src="https://cdn.rawgit.com/mdehoog/Semantic-UI-Calendar/76959c6f7d33a527b49be76789e984a0a407350b/dist/calendar.min.js"></script>

<!-- data table cdn -->
<script src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.18/js/dataTables.semanticui.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.18/css/dataTables.semanticui.min.css">



<!-- better use rmarkdown internal syntax highlighting -->
<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css"> 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/r.min.js">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>--->
<!-- down before body tag -->
<!--<script>hljs.initHighlightingOnLoad();</script>-->

<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
pre, code {
  background-color: #f7f7f7;
  border-radius: 3px;
  color: #333;
  white-space: pre-wrap;    
}
pre {
  border-radius: 3px;
  margin: 5px 0px 10px 0px;
  padding: 10px;
}
pre:not([class]) {
  background-color: white;
}
code:not([class]) {
  background-color: white;
}
code {
  font-family: Consolas, Monaco, 'Courier New', monospace;
  font-size: 85%;
}
p > code, li > code {
  padding: 2px 0px;
}
</style>

</head>
<body>
<div class = "wrapper">
<p>Die logistische Regression kann anfangs Kopfschmerzen verursachen. Während die Struktur und die Idee der “normalen” Regression entsprechen, kann die Interpretation der b’s (d.h. der Regressionskoeffizienten) schwieriger sein.</p>
<p>Dieser Post bietet eine praktische Funktion zum Konvertieren der logits (das wird von ´glm´ ausgegeben) in eine Wahrscheinlichkeit.</p>
<div id="packages-einladen" class="section level3">
<h3>Packages einladen</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#install.packages(&quot;pacman&quot;)</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#pacman::p_install_gh(&quot;favstats/tidytemplate&quot;)</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">pacman<span class="op">::</span><span class="kw">p_load</span>(tidyverse, magrittr, haven, sjPlot, sjmisc, ggeffects, texreg, car, psych, knitr, labelled, broom, margins, tidytemplate)</a></code></pre></div>
<p><strong>Achtung wenn ihr nicht Rstudio Cloud benutzt: für viele der Funktionen hier braucht ihr die aktuellste Version von <code>tidytemplate</code></strong></p>
<p>Installieren könnt ihr diese auf folgende Weise:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#installiere pacman falls es noch nicht installiert ist</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#install.packages(&quot;pacman&quot;)</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">pacman<span class="op">::</span><span class="kw">p_install_gh</span>(<span class="st">&quot;systats/semantic.doc&quot;</span>)</a></code></pre></div>
</div>
<div id="datensatz-einladen" class="section level3">
<h3>Datensatz einladen</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">allbus &lt;-<span class="st"> </span><span class="kw">read_spss</span>(<span class="st">&quot;../../data/allbus2014.sav&quot;</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">allb_sub &lt;-<span class="st"> </span>allbus <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">      </span><span class="kw">select</span>(V84, V86, V81, V419)  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">      </span><span class="kw">rename</span>(<span class="dt">alter =</span> V84, </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">       <span class="dt">bildung =</span> V86, </a>
<a class="sourceLine" id="cb3-6" data-line-number="6">       <span class="dt">geschl  =</span> V81,  </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">       <span class="dt">einkommen  =</span> V419) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">alter0 =</span> alter <span class="op">-</span><span class="st"> </span><span class="dv">18</span>,</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">       <span class="dt">bildung_rec =</span> <span class="kw">ifelse</span>(bildung <span class="op">==</span><span class="st"> </span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>bildung <span class="op">==</span><span class="st"> </span><span class="dv">7</span>, <span class="ot">NA</span>, bildung <span class="op">-</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">       <span class="dt">geschl_rec =</span> <span class="kw">ifelse</span>(geschl <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">      </span><span class="kw">mutate_all</span>(as.numeric) <span class="co"># alle Werte als numerisch ausgeben</span></a></code></pre></div>
</div>
<div id="neue-variable-hohes-einkommen" class="section level3">
<h3>Neue Variable: hohes Einkommen</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">allb_sub <span class="op">%&lt;&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">einkommen_h =</span> <span class="kw">ifelse</span>(einkommen <span class="op">&gt;</span><span class="st"> </span><span class="dv">2500</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">allb_sub <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span>janitor<span class="op">::</span><span class="kw">tabyl</span>(einkommen_h) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">einkommen_h</th>
<th align="right">n</th>
<th align="right">percent</th>
<th align="right">valid_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">2655</td>
<td align="right">0.7649092</td>
<td align="right">0.8662316</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">410</td>
<td align="right">0.1181216</td>
<td align="right">0.1337684</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">406</td>
<td align="right">0.1169692</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Tipp: Der <code>%&lt;&gt;%</code> Operator aus dem <code>magrittr</code> package erspart ein wenig Tipparbeit. Stattdessen könnten wir auch (wie üblich) schreiben:</p>
</blockquote>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">allb_sub &lt;-<span class="st"> </span>allb_sub <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">einkommen_h =</span> <span class="kw">ifelse</span>(einkommen <span class="op">&gt;</span><span class="st"> </span><span class="dv">2500</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a></code></pre></div>
</div>
<div id="berechnen-wir-jetzt-unser-modell" class="section level3">
<h3>Berechnen wir jetzt unser Modell:</h3>
<p>Die Syntax für ein logistisches Modell ähnelt sehr der Syntax für ein lineares Modell. Man benutzt einfach die Funktion <code>glm()</code> (steht für <em>generalized linear model</em>) und spezifiziert am Ende <code>family = &quot;binomial&quot;</code> um ein Modell für ein dichotomes logistisches Modell zu berechnen.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">mod1 &lt;-<span class="st"> </span><span class="kw">glm</span>(einkommen_h <span class="op">~</span><span class="st"> </span>bildung_rec <span class="op">+</span><span class="st"> </span>geschl_rec <span class="op">+</span><span class="st"> </span>alter0, </a>
<a class="sourceLine" id="cb6-2" data-line-number="2">            <span class="dt">data =</span> allb_sub, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">htmlreg</span>(mod1,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">          <span class="co"># better for html in markdown</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">          <span class="dt">doctype =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">          <span class="dt">html.tag =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">          <span class="dt">head.tag =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table cellspacing="0" align="center" style="border: none;">
<caption align="bottom" style="margin-top:0.3em;">
Statistical models
</caption>
<tr>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b></b>
</th>
<th style="text-align: left; border-top: 2px solid black; border-bottom: 1px solid black; padding-right: 12px;">
<b>Model 1</b>
</th>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
(Intercept)
</td>
<td style="padding-right: 12px; border: none;">
-5.64<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.26)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
bildung_rec
</td>
<td style="padding-right: 12px; border: none;">
0.75<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.05)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
geschl_rec
</td>
<td style="padding-right: 12px; border: none;">
1.85<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.14)
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
alter0
</td>
<td style="padding-right: 12px; border: none;">
0.02<sup style="vertical-align: 0px;">***</sup>
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
</td>
<td style="padding-right: 12px; border: none;">
(0.00)
</td>
</tr>
<tr>
<td style="border-top: 1px solid black;">
AIC
</td>
<td style="border-top: 1px solid black;">
1969.52
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
BIC
</td>
<td style="padding-right: 12px; border: none;">
1993.60
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Log Likelihood
</td>
<td style="padding-right: 12px; border: none;">
-980.76
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;">
Deviance
</td>
<td style="padding-right: 12px; border: none;">
1961.52
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid black;">
Num. obs.
</td>
<td style="border-bottom: 2px solid black;">
3039
</td>
</tr>
<tr>
<td style="padding-right: 12px; border: none;" colspan="3">
<span style="font-size:0.8em"><sup style="vertical-align: 0px;"><em><strong></sup>p &lt; 0.001, <sup style="vertical-align: 0px;"></strong></sup>p &lt; 0.01, <sup style="vertical-align: 0px;"></em></sup>p &lt; 0.05</span>
</td>
</tr>
</table>
<blockquote>
<p>Wenn der Koeffizient (logit) positiv ist, ist der Effekt dieses Prädiktors positiv und umgekehrt.</p>
</blockquote>
<p>Hier sind die Koeffizienten <em>positiv</em>, was anzeigt, dass sowohl höhere Bildung und Alter sowie männliches Geschlecht die Wahrscheinlichkeit erhöht in einer höheren Einkommensklasse zu sein (Einkommen &gt; 2500). Neben der Signifikanz der Koeffizienten, lässt sich aus dem logit allerdings nicht direkt (zumindest nicht intuitiv) die Stärke des Effekts ablesen sondern nur die <strong>Richtung</strong>.</p>
</div>
<div id="wahrscheinlichkeit-berechnen-mit-logits" class="section level3">
<h3>Wahrscheinlichkeit berechnen mit logits</h3>
<p>Die folgenden 3 Schritte konvertieren einen logit-Koeffizienten in eine Wahrscheinlichkeit:</p>
<p><strong>1. Extrahiere die logit-Koeffizienten</strong></p>
<p><strong>2. Berechne zunächst das <span class="math inline">\(\hat z_i\)</span> (vorhergesagter logit) und dann damit die Odds <span class="math inline">\(e^{\hat z_i}\)</span></strong></p>
<p><strong>3. Berechne die Wahrscheinlichkeit mit Hilfe der Odds <span class="math inline">\(\frac{e^{\hat z_i}}{1 +e^{\hat z_i}}\)</span></strong></p>
</div>
<div id="anwendungsfall" class="section level3">
<h3>Anwendungsfall</h3>
<p><em>Frage: Wie wahrscheinlich ist es, dass eine 30-Jährige Frau mit höchster Bildung ein Netto-Einkommen über 2500 Euro pro Monat bekommt?</em></p>
<ul>
<li>Alter: 30</li>
<li>Geschlecht: Frau</li>
<li>Bildung: Höchste Bildungstufe</li>
</ul>
<p><strong>1. Extrahiere die logit-Koeffizienten</strong></p>
<p>Um es ein bisschen zu vereinfachen habe ich eine kleine Funktion geschrieben, welche die Koeffizienten im <em>wide</em> Format ausgibt:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">tidy_wide &lt;-<span class="st"> </span><span class="cf">function</span>(model) {</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  model_wide &lt;-<span class="st"> </span><span class="kw">tidy</span>(model) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># tidy extrahiert die Parameter</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(term, estimate) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># wir brauchen nur die logit-koeffs</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="kw">spread</span>(term, estimate) <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># konvertieren in wide format</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">intercept =</span> <span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span>) <span class="co"># umbenennen</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  <span class="kw">return</span>(model_wide)            <span class="co"># gib model_wide aus</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">}</a></code></pre></div>
<p>Die <code>tidy_wide</code> Funktion befindet sich im <code>tidytemplate</code> package. Wenn ihr die Rstudio Cloud benutzt, dann ist diese schon vorinstalliert und geladen.</p>
<p>Probieren wir die Funktion doch einmal aus:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">mod1_wide &lt;-<span class="st"> </span><span class="kw">tidy_wide</span>(mod1)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">mod1_wide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">intercept</th>
<th align="right">alter0</th>
<th align="right">bildung_rec</th>
<th align="right">geschl_rec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-5.640335</td>
<td align="right">0.0172347</td>
<td align="right">0.7498078</td>
<td align="right">1.851376</td>
</tr>
</tbody>
</table>
<p><strong>2. Berechne zunächst das <span class="math inline">\(\hat z_i\)</span> (vorhergesagter logit) auf folgende Art und Weise:</strong></p>
<p><span class="math display">\[\hat z_i = a + b \times X_i\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">mod1_wide <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> intercept <span class="op">+</span><span class="st"> </span><span class="dv">12</span> <span class="op">*</span><span class="st"> </span>alter0 <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>bildung_rec <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">*</span><span class="st"> </span>geschl_rec)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">mod1_wide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">intercept</th>
<th align="right">alter0</th>
<th align="right">bildung_rec</th>
<th align="right">geschl_rec</th>
<th align="right">z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-5.640335</td>
<td align="right">0.0172347</td>
<td align="right">0.7498078</td>
<td align="right">1.851376</td>
<td align="right">-2.434287</td>
</tr>
</tbody>
</table>
<p>Wenn wir die vorhergesagten logits (<span class="math inline">\(\hat z_i\)</span>) berechnet haben, können wir diese benutzen um die Odds zu erhalten. <strong>Odds</strong> (Chancen) sind einfach die eulersche Zahl hoch die logits (wird mit <code>exp()</code> berechnet)</p>
<p><span class="math display">\[e^{\hat z_i} = Odds\]</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">mod1_wide <span class="op">%&lt;&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">odds =</span> <span class="kw">exp</span>(z))</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">mod1_wide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">intercept</th>
<th align="right">alter0</th>
<th align="right">bildung_rec</th>
<th align="right">geschl_rec</th>
<th align="right">z</th>
<th align="right">odds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-5.640335</td>
<td align="right">0.0172347</td>
<td align="right">0.7498078</td>
<td align="right">1.851376</td>
<td align="right">-2.434287</td>
<td align="right">0.0876602</td>
</tr>
</tbody>
</table>
<p>Die Chance, dass eine 30 Jährige Frau mit höchstem Bildungsabschluss ein hohes Einkommen erhält ist</p>
<p><strong>3. Jetzt wo die Odds bekannt sind, können diese einfach in Warscheinlichkeiten umgerechnet werden mit der folgenden Formel: </strong></p>
<p><span class="math display">\[p_i(y=1) = \frac{1}{1 + e^{- \hat z_i}} = \frac{e^{\hat z_i}}{1 +e^{\hat z_i}} = Wahrscheinlichkeit\]</span></p>
<p>Das Ergebnis ist die Wahrscheinlichkeit, dass die Ausprägung 1 (hier: hohes Einkommen) unter den angegeben Prädiktoren eintritt.</p>
<p><em>Formel 1</em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">mod1_wide <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>z)))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">mod1_wide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">intercept</th>
<th align="right">alter0</th>
<th align="right">bildung_rec</th>
<th align="right">geschl_rec</th>
<th align="right">z</th>
<th align="right">odds</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-5.640335</td>
<td align="right">0.0172347</td>
<td align="right">0.7498078</td>
<td align="right">1.851376</td>
<td align="right">-2.434287</td>
<td align="right">0.0876602</td>
<td align="right">0.0805952</td>
</tr>
</tbody>
</table>
<p><em>Formel 2</em></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">mod1_wide <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> <span class="kw">exp</span>(z) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(z)))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">mod1_wide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">intercept</th>
<th align="right">alter0</th>
<th align="right">bildung_rec</th>
<th align="right">geschl_rec</th>
<th align="right">z</th>
<th align="right">odds</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-5.640335</td>
<td align="right">0.0172347</td>
<td align="right">0.7498078</td>
<td align="right">1.851376</td>
<td align="right">-2.434287</td>
<td align="right">0.0876602</td>
<td align="right">0.0805952</td>
</tr>
</tbody>
</table>
<p><em>Oder als Funktion (im <code>tidytemplate</code> package enthalte):</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">logit2prob &lt;-<span class="st"> </span><span class="cf">function</span>(logit) { <span class="co"># logit ist der input</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">  odds &lt;-<span class="st"> </span><span class="kw">exp</span>(logit)          <span class="co"># e hoch logit = odds</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">  prob &lt;-<span class="st"> </span>odds <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>odds)   <span class="co"># odds / 1 + odds = Wahrscheinlichkeit</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">  <span class="kw">return</span>(prob)               <span class="co"># gibt Wahrscheinlichkeit zurück</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">}</a></code></pre></div>
<p><em>Anwendung:</em></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">mod1_wide <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> <span class="kw">logit2prob</span>(z))</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">mod1_wide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">intercept</th>
<th align="right">alter0</th>
<th align="right">bildung_rec</th>
<th align="right">geschl_rec</th>
<th align="right">z</th>
<th align="right">odds</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-5.640335</td>
<td align="right">0.0172347</td>
<td align="right">0.7498078</td>
<td align="right">1.851376</td>
<td align="right">-2.434287</td>
<td align="right">0.0876602</td>
<td align="right">0.0805952</td>
</tr>
</tbody>
</table>
<p>Laut Model 1 beträgt die Wahrscheinlichkeit für eine 30 - Jährige Frau mit höchstem Bildungsabschluss über 2500 Euro im Monat zu verdienen 8.06%.</p>
</div>
<div id="andere-methoden-fur-wahrscheinlichkeit" class="section level3">
<h3>Andere Methoden für Wahrscheinlichkeit:</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">predict</span>(mod1, <span class="kw">data.frame</span>(<span class="dt">alter0 =</span> <span class="dv">12</span>,</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">                         <span class="dt">bildung_rec =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">                         <span class="dt">geschl_rec =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb15-4" data-line-number="4">        <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<pre><code>     1 </code></pre>
<p>0.08059523</p>
</div>
<div id="aber-wie-berechnet-man-odds-ratios" class="section level3">
<h3>Aber wie berechnet man Odds Ratios?</h3>
<p>Ganz einfach!</p>
<p>Einfach den dazugehörigen logit-Koeffizienten als Hochzahl für die eulersche Zahl nehmen!</p>
<p><span class="math display">\[e^{b_i} = Odds Ratios\]</span></p>
<p>Beispiel:</p>
<p>Um schnell die Odds Ratios für unsere Koeffizienten zu erhalten können wir ganz einfach <code>tidy</code> aus dem <code>broom</code> package benutzen.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">tidy</span>(mod1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-5.6403353</td>
<td align="right">0.2563134</td>
<td align="right">-22.005622</td>
<td align="right">0.000000</td>
</tr>
<tr class="even">
<td align="left">bildung_rec</td>
<td align="right">0.7498078</td>
<td align="right">0.0517355</td>
<td align="right">14.493088</td>
<td align="right">0.000000</td>
</tr>
<tr class="odd">
<td align="left">geschl_rec</td>
<td align="right">1.8513756</td>
<td align="right">0.1434395</td>
<td align="right">12.907018</td>
<td align="right">0.000000</td>
</tr>
<tr class="even">
<td align="left">alter0</td>
<td align="right">0.0172347</td>
<td align="right">0.0035245</td>
<td align="right">4.889965</td>
<td align="right">0.000001</td>
</tr>
</tbody>
</table>
<p>Die Spalte <code>estimate</code> gibt den Logit-Koeffizienten an. Daher berechnen wir folgendermaßen die Odds Ratios:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">tidy</span>(mod1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">odds_ratio =</span> <span class="kw">exp</span>(estimate)) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">odds_ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-5.6403353</td>
<td align="right">0.2563134</td>
<td align="right">-22.005622</td>
<td align="right">0.000000</td>
<td align="right">0.0035517</td>
</tr>
<tr class="even">
<td align="left">bildung_rec</td>
<td align="right">0.7498078</td>
<td align="right">0.0517355</td>
<td align="right">14.493088</td>
<td align="right">0.000000</td>
<td align="right">2.1165932</td>
</tr>
<tr class="odd">
<td align="left">geschl_rec</td>
<td align="right">1.8513756</td>
<td align="right">0.1434395</td>
<td align="right">12.907018</td>
<td align="right">0.000000</td>
<td align="right">6.3685742</td>
</tr>
<tr class="even">
<td align="left">alter0</td>
<td align="right">0.0172347</td>
<td align="right">0.0035245</td>
<td align="right">4.889965</td>
<td align="right">0.000001</td>
<td align="right">1.0173841</td>
</tr>
</tbody>
</table>
<p>Die Chance ein hohes Einkommen zu haben für jemanden der gar keinen Bildungsabschluss hat ist 2.12 mal höher im Vergleich zu jemanden mit einem Hauptschulabschluss.</p>
<p>Die Odds Ratios sind tatsächlich <strong>gleich</strong> für jeden Sprung auf der x-Achse.</p>
<p><strong>Ein paar interessante Werte:</strong></p>
<p>Denke daran, dass <span class="math inline">\(e^1 ≈ 2.71\)</span>. Das heißt, wenn der Logit 1 ist, liegen die Chancen bei ca. 2,7 zu 1, so ist die Wahrscheinlichkeit <span class="math inline">\(\frac{2.7}{1 + 2.7}\)</span>, also ca. 0.73 oder 73%.</p>
<p>Ähnlich interessant ist ein Logit von 0, was die folgenden Odds ergibt: <span class="math inline">\(e^0 = 1\)</span>. Daher liegen die Chancen 1 : 1, d.h. bei 50%.</p>
<p>Wenn der logit also negativ ist, liegt die zugehörige Wahrscheinlichkeit unter 50% und umgekehrt (positives logit &lt;-&gt; Wahrscheinlichkeit über 50%).</p>
<p>Das lässt sich auch schematisch in einer Tabelle darstellen:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">logit_seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">prob_seq &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">logit2prob</span>(logit_seq), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"></a>
<a class="sourceLine" id="cb19-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Logit =</span> logit_seq,</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">                 <span class="dt">Wahrscheinlichkeit =</span> prob_seq)</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw">kable</span>(df)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Logit</th>
<th align="right">Wahrscheinlichkeit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-10</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="right">-8</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="right">-6</td>
<td align="right">0.002</td>
</tr>
<tr class="even">
<td align="right">-4</td>
<td align="right">0.018</td>
</tr>
<tr class="odd">
<td align="right">-2</td>
<td align="right">0.119</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0.500</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">0.881</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.982</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">0.998</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">1.000</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
<p>Oder als Grafik:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">logit_seq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">prob_seq &lt;-<span class="st"> </span><span class="kw">logit2prob</span>(logit_seq)</a>
<a class="sourceLine" id="cb20-4" data-line-number="4"></a>
<a class="sourceLine" id="cb20-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Logit =</span> logit_seq,</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">                 <span class="dt">Wahrscheinlichkeit =</span> prob_seq)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="kw">ggplot</span>(df) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> logit_seq, <span class="dt">y =</span> prob_seq) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Logit&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wahrscheinlichekit der Ausprägung 1 in y&quot;</span>)</a></code></pre></div>
<p><img src="06ua_r_tippsntricks_files/figure-html/unnamed-chunk-18-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="visualisierung-mit-sjplot" class="section level3">
<h3>Visualisierung mit <code>sjPlot</code></h3>
<p>Mit dem Package <code>sjPlot</code> lässt sich auch eine logistische Regression sehr schön darstellen. Man muss dazu <strong>nichts</strong> zusätzlich angeben, da die Funktion automatisch ein logistisches Modell entdeckt und die entsprechenden Werte zurückgibt.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">library</span>(sjPlot) <span class="co">#bzw. in pacman einladen</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw">plot_model</span>(mod1, <span class="dt">show.values =</span> T, <span class="dt">show.p =</span> T)</a></code></pre></div>
<p><img src="06ua_r_tippsntricks_files/figure-html/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Die Wahrscheinlichkeiten mit zunehmenden Alter</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">plot_model</span>(mod1, <span class="dt">terms =</span> <span class="st">&quot;alter0&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>)</a></code></pre></div>
<p><img src="06ua_r_tippsntricks_files/figure-html/unnamed-chunk-20-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Die Wahrscheinlichkeiten mit zunehmenden Alter und Bildung</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">plot_model</span>(mod1, <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;alter0&quot;</span>, <span class="st">&quot;bildung_rec&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>)</a></code></pre></div>
<p><img src="06ua_r_tippsntricks_files/figure-html/unnamed-chunk-21-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Die Wahrscheinlichkeiten mit zunehmenden Alter, Bildung, getrennt nach Geschlecht</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">plot_model</span>(mod1, <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;alter0&quot;</span>, <span class="st">&quot;bildung_rec&quot;</span>, <span class="st">&quot;geschl_rec&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;pred&quot;</span>)</a></code></pre></div>
<p><img src="06ua_r_tippsntricks_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="average-marginal-effects-plot" class="section level3">
<h3>Average Marginal Effects Plot</h3>
<p>Hierzu zunächst eine Hifsfunktion (ist im <code>tidytemplate</code> package enthalten)</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">plot_ame &lt;-<span class="st"> </span><span class="cf">function</span>(mod1) {</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb25-3" data-line-number="3">model_dat &lt;-<span class="st"> </span><span class="kw">margins</span>(mod1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb25-5" data-line-number="5">model_dat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">AME =</span> AME <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lower =</span> lower <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">upper =</span> upper <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">stars =</span> tidytemplate<span class="op">::</span><span class="kw">get_stars</span>(p)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">AME_label =</span> <span class="kw">round</span>(AME, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">AME_label =</span> <span class="kw">paste0</span>(AME_label, stars)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(factor, AME)) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> factor, <span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.75</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(factor, AME, <span class="dt">label =</span> AME_label), <span class="dt">nudge_y =</span> <span class="fl">0.6</span>, <span class="dt">nudge_x =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-18" data-line-number="18"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average Marginal Effect (AME)&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Average Marginal Effects Plot&quot;</span>)</a>
<a class="sourceLine" id="cb25-20" data-line-number="20">}</a></code></pre></div>
<p>Die Anwendung ist einfach:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">plot_ame</span>(mod1)</a></code></pre></div>
<p><img src="06ua_r_tippsntricks_files/figure-html/unnamed-chunk-24-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>So können wir interpretieren, dass die Wahrscheinlichkeit in einer hohen Einkommensstufe zu sein um 18.03% für einen Mann im Vergleich zu einer Frau steigt. Die Wahrscheinlichkeit in einer hohen Einkommensstufe zu sein nimmt im Schnitt 7.3% für jede Bildungsstufe zu.</p>
</div>
</div>


<!-- dynamically load mathjax for compatibility with self-contained -->
<!--<script async src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"async></script>-->

<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- -->
</body>
</html>
